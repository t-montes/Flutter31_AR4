<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Blog - Flutter31 Bootstrap Template</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- t-montes code-viewer -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
  <script type="module" src="https://cdn.jsdelivr.net/gh/t-montes/code-viewer@master/versions/1.0.1/code-viewer.min.js"></script>

  <!-- =======================================================
  * Template Name: Flutter31
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/flexstart-bootstrap-startup-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center">
        <img src="assets/img/logo.png" alt="">
        <span>Flutter31</span>
      </a>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="index.html#hero">Start</a></li>
          <li class="dropdown"><a href="index.html#appinfo"><span>Overview</span><i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a href="index.html#appinfo">Blackhole</a></li>
              <li><a href="index.html#appinfo_functionalities">Functionalities</a></li>
              <li><a href="index.html#appinfo_value">Value Proposition</a></li>
              <li><a href="index.html#appinfo_libraries">Libraries</a></li>
              <li><a href="index.html#appinfo_bqs">Business Questions</a></li>
            </ul>
          </li>
          <li class="dropdown"><a href="ar2.html"><span>Design</span><i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a href="ar2.html#architecture">Architecture</a></li>
              <li><a href="ar2.html#views">App Views</a></li>
              <li><a href="ar2.html#qas">Quality Attributes</a></li>
            </ul>
          </li>
          <li class="dropdown"><a href="ar3.html"><span>Techniques</span><i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a href="ar3.html#ecns">Eventual Connectivity</a></li>
              <li><a href="ar3.html#caching">Caching Strategies</a></li>
              <li><a href="ar3.html#memory">Memory Managment</a></li>
              <li><a href="ar3.html#threading">Threading</a></li>
            </ul>
          </li>
          <li class="dropdown"><a href="ar4.html"><span>Performance</span><i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a href="ar4.html#scenarios">Performance Scenarios</a></li>
              <li><a href="ar4.html#overdrawing">Overdrawing</a></li>
              <li><a href="ar4.html#memory-leaks-library">Memory Leaks</a></li>
              <li><a href="ar4.html#uoptimization">Micro Optimization</a></li>
              <li><a href="ar4.html#prs">Pull Requests</a></li>
            </ul>
          </li>
          <li><a class="nav-link scrollto" href="sonar.html">Sonar</a></li>
          <li><a class="getstarted scrollto" href="https://blackhole-apk.com/">Download</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>


    </div>
  </header>

  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section class="breadcrumbs">
      <div class="container">
        <ol>
          <li><a href="index.html">Home</a></li>
          <li><a href="ar4.html">Performance</a></li>
        </ol>
        <h2>Performance</h2>
      </div>
    </section>

    <!-- ======= Section: Performance ======= -->
    <section id="scenarios" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>Defined Scenarios</h2>
          <p>Performance Analysis Scenarios</p>
        </header>

        <div class="testimonials-slider swiper" data-aos="fade-up" data-aos-delay="100">
          <div class="swiper-wrapper">

            <div class="swiper-slide">
              <a href="#ecn1" class="clickable-div">
                <div class="testimonial-item">
                <h3>Foreground Song Playing</h3>
                <h4>Scenario 1</h4>
                  <div class="stars">
                    <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                  </div>
                  <p>
                    The user opens the app, chooses a song, and initiates playback while keeping the app open.
                  </p>
                  <div class="profile mt-auto">
                    <img src="assets/img/pf1-dalle.png" class="testimonial-img" alt="">
                  </div>
                </div>
              </a>
            </div>

            <div class="swiper-slide">
              <a href="#ecn2" class="clickable-div">
                <div class="testimonial-item">
                <h3>Download Playlist</h3>
                <h4>Scenario 2</h4>
                  <div class="stars">
                    <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                  </div>
                  <p>
                    The user chooses a playlist and selects the "Download Playlist" button.
                  </p>
                  <div class="profile mt-auto">
                    <img src="assets/img/pf2-dalle.png" class="testimonial-img" alt="">
                  </div>
                </div>
              </a>
            </div>

            <div class="swiper-slide">
              <a href="#ecn3" class="clickable-div">
                <div class="testimonial-item">
                <h3>Background Song Playing</h3>
                <h4>Scenario 3</h4>
                <div class="stars">
                    <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                  </div>
                  <p>
                    The user plays a song and switches to another application, allowing the music to seamlessly continue playing in the background.
                  </p>
                  <div class="profile mt-auto">
                    <img src="assets/img/pf3-dalle.png" class="testimonial-img" alt="">
                  </div>
                </div>
              </a>
            </div>

            <div class="swiper-slide">
              <a href="#ecn4" class="clickable-div">
                <div class="testimonial-item">
                <h3>Play Offline Song</h3>
                <h4>Scenario 4</h4>
                <div class="stars">
                    <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                  </div>
                  <p>
                    The user, without internet connectivity, chooses to play a song that has already been downloaded in the app.
                  </p>
                  <div class="profile mt-auto">
                    <img src="assets/img/pf4-dalle.png" class="testimonial-img" alt="">
                  </div>
              </div>
              </a>
            </div>

            <div class="swiper-slide">
              <a href="#ecn5" class="clickable-div">
                <div class="testimonial-item">
                <h3>Song Search</h3>
                <h4>Scenario 5</h4>
                <div class="stars">
                    <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                  </div>
                  <p>
                    The user searches for a specific song on YouTube within the app for playback.
                  </p>
                  <div class="profile mt-auto">
                    <img src="assets/img/pf5-dalle.png" class="testimonial-img" alt="">
                  </div>
                </div>
              </a>
            </div>

          </div>
          <div class="swiper-pagination"></div>
        </div>
      </div>
    </section>
  
    <section id="ecn1" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>Scenario 1</h2>
          <p>Foreground Song Playing</p>
        </header>

        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn1Video_1" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1mMCVCNEl4X07m4-mcpX6RxG3z-flwFv9" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>


          <div class="col-lg-5">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>GPU frame rate</h3>
              <p>The video shows what happens when a song that hasn't been played before is selected. The framerate starts fluctuating too much because the application, while playing the song, is catching the entire song. This is because the system must retrieve and process the audio data in real-time, creating a strain on resources. Consequently, the frame time on the screen increases, indicating a slower rendering of frames, frames now are rendered every 20ms in average. In simpler terms, loading a song directly impacts the smoothness of the overall experience, causing delays in frame updates and affecting the perceived responsiveness of the application or system.</p>
            </div>
          </div>
        </div>

        <br>

        <div class="row">
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>CPU usage</h3>
              <p>Analyzing the graph, we can observe that when selecting the download of a song for almost seven seconds, the application engages in tasks such as buffering, music synchronization, streaming download management, and validating the playback time of the song and whether it has been fully downloaded. Once these tasks are completed, smaller processes commence, lasting between 3 and 4 seconds.</p>
            </div>
          </div>

          <div class="col-lg-7" data-aos="zoom-out" data-aos-delay="100">
            <img src="assets/img/esc_1_Cpu.png" class="img-fluid custom-image" alt="">
          </div>
        </div>

        <br>

        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn1Video_2" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1P5_FfcgxZpMFWzUo6_pe0fJUcxuP3B_Z" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>

          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>RAM Consumption</h3>
              <p>The application's RAM usage initiates upon clicking a song, as it begins to gather and store information in the cache memory. The frames per second maintain a consistently low average, approximately around 40. This issue arises from the app struggling to render frame times, primarily due to the prevalence of slow frames (Jank). This is evident in the graph by the high coral-color bars.</p>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Memory Leaks</h3>
              <p>As presented in the snapshot, there are two big memory leaks in the app. We can identify the memory leaks when we see Peaks in the timeline. As shown in the video, there are two major peaks in which the app grows its memory size and stabilizes.</p>
            </div>
          </div>

          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Garbage Collection</h3>
              <p>The Garbage Collector (GC) is invoked very frequently in the application. In the graph, this is visually represented by a recurring blue dot appearing consistently above the orange dotted line. The prevalence of this blue dot across the entire timeline indicates that the app excessively caches song data, leading to frequent clean-up operations by the GC for unused data.</p>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Threading</h3>
              <p>This scenario utilizes the audioHandler package from Flutter, this package uses threading to play the music in the background even without connectivity. This thread is in charge of queueing audio events, seeking audio, playing audio and pausing audio. This thread allows all the audio related functions to be working outside of the main thread, this is great for playing on background and using the rest of the functions of the app while playing music. In the case of not having connection, the queuing is made from the stored songs.</p>
            </div>
          </div>

          <div class="col-lg-6" style="align-items: center;">
            <div class="code-space">
              <code-viewer title="audioplayer.dart">
                IconButton(
                  tooltip: AppLocalizations.of(context)!.play,
                  onPressed: audioHandler.play,
                  icon: const Icon(
                    Icons.play_arrow_rounded,
                  ),
                  color: Theme.of(context).iconTheme.color,
                ),
              </code-viewer>
            </div>
          </div>
        </div>

      </div>
    </section>        

    <section id="ecn2" class="testimonials">
      <div class="container" data-aos="fade-up">
    
        <header class="section-header">
          <h2>Scenario 2</h2>
          <p>Download Playlist</p>
        </header>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn2Video_1" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1qwfcNoX5RF0AFX79NwRT9i_yo5b2h-9h" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Frame rate</h3>
              <p>As observed in the video, selecting the playlist download option results in an increase in the average frame rate to approximately 50 FPS. However, a significant majority of these frames fall into the category of "slow frames," commonly known as "Jank." This indicates that the frames are taking considerably longer to render that it should be.</p>
            </div>
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>CPU</h3>
              <p>Analyzing the graph, we can observe that when selecting the download of a song for almost seven seconds, the application engages in tasks such as buffering, music synchronization, streaming download management, and validating the playback time of the song and whether it has been fully downloaded. Once these tasks are completed, smaller processes commence, lasting between 3 and 4 seconds.</p>
            </div>
          </div>
    
          <div class="col-lg-7" data-aos="zoom-out" data-aos-delay="100">
            <img src="assets/img/esc_2_Cpu.png" class="img-fluid custom-image" alt="">
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn2Video_2" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1b-j-bw2Fo7YQu1YkXmu2Z_h0DzGXqXNa" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>RAM Consumption</h3>
              <p>When we analyze the RAM consumption while downloading a playlist, we observe that each song is being downloaded and that there is a high percentage of memory size utilization. Furthermore, on average, every 5 seconds there is a peak in memory usage. This can be explained by the fact that, at intervals, the download connection performs so well that the application begins to request a bit more data to store in the mobile device's memory (Local Storage), aiming to download the songs as quickly as possible.</p>
            </div>
          </div>
        </div>
    
        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Memory Leaks</h3>
              <p>As illustrated in the snapshot, the application displays two notable memory leaks. The first occurrence is identified during the initial peak, causing a brief freeze lasting about a second. This interruption seems linked to the simultaneous download of the first playlist song and the commencement of the download for the subsequent second song. The second memory leak becomes evident later in the video playback, coinciding with the completion of the second song download, as the app initiates the download for the third song.</p>
            </div>
          </div>
    
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Garbage Collection</h3>
              <p>The presence of the Garbage Collector (GC) is evident throughout the memory usage timeline, symbolized by a persistent blue dot positioned consistently above the orange dotted line. As the timeline unfolds, the prevalence of this recurring blue dot signifies the continuous task of the garbage collector in cleaning up the memory space that the application does not longer requires, particularly during the process of downloading songs.</p>
            </div>
          </div>
        </div>
    
        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Threading</h3>
              <p>The following snippets allow the understanding of how threading is used when Downloading a playlist. The downloading of a playlists uses the Download component that inherits the notifiers from ChangeNotifier. Additionally, the next snippet presents the function that is called when a song is downloaded on demand. This function uses async and returns a Future so all the listeners can know when a song has been downloaded. This allows other views to present different icons when songs are already downloaded.</p>
            </div>
          </div>
    
          <div class="col-lg-6" style="align-items: center;">
            <div class="code-space">
              <code-viewer title="download.dart">
                class Download with ChangeNotifier {
                  static final Map&lt;String, Download&gt; _instances = {};
                  final String id;
              </code-viewer>
              <code-viewer title="download.dart">
                Future&lt;void&gt; downloadSong(
                  BuildContext context,
                  String? dlPath,
                  String fileName,
                  Map data,
                ) async {
                  Logger.root.info('processing download');
                  progress = null;
                  notifyListeners();
                  String? filepath;
                  late String filepath2;
                  String? appPath;
                  final List&lt;int&gt; bytes = [];
                  String lyrics = '';
                  final artname = fileName.replaceAll('.m4a', '.jpg');
                  if (!Platform.isWindows) {
                    Logger.root.info('Getting App Path for storing image');
                    appPath = Hive.box('settings').get('tempDirPath')?.toString();
                    appPath ??= (await getTemporaryDirectory()).path;
                  } else {
                    final Directory? temp = await getDownloadsDirectory();
                    appPath = temp!.path;
                  }
              

              </code-viewer>
            </div>
          </div>
        </div>
    
      </div>
    </section>

    <section id="ecn3" class="testimonials">
      <div class="container" data-aos="fade-up">
    
        <header class="section-header">
          <h2>Scenario 3</h2>
          <p>Background Song Playing</p>
        </header>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn3Video_1" loop controls muted style="width: 100%;">
              <!-- TODO: change URL of performance -->
              <source src="https://drive.google.com/uc?export=download&id=18cdrsPm2YShdw8ieUumRlQJOsKNUCeI8" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Frame rate</h3>
              <p>The mobile device maintains a stable frame rate of around 60 frames per second, as it is running an application that isn't consuming resources or making requests to any server. As evident in the video, the music continues to play in the control panel. Since the Chrome application is in the foreground (it's a Visible Process), the frames run smoothly, benefiting from the fact that the BlackHole music is playing in the background.</p>
            </div>
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>CPU</h3>
              <p>Examining the CPU usage graph reveals that when changing a song from the control panel, several tasks take place without blocking the application. These tasks, at most, take 1.5 seconds, primarily involving invocations to draw the image of the currently playing song on the control panel.</p>
            </div>
          </div>
    
          <div class="col-lg-7" data-aos="zoom-out" data-aos-delay="100">
            <img src="assets/img/esc_3_Cpu.png" class="img-fluid custom-image" alt="">
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn3Video_2" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=18cdrsPm2YShdw8ieUumRlQJOsKNUCeI8" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <!--TODO: uncomment <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>RAM Consumption</h3>
              <p>When we analyze the RAM consumption while downloading a playlist, we observe that each song is being downloaded and that there is a high percentage of memory size utilization. Furthermore, on average, every 5 seconds there is a peak in memory usage. This can be explained by the fact that, at intervals, the download connection performs so well that the application begins to request a bit more data to store in the mobile device's memory (Local Storage), aiming to download the songs as quickly as possible.</p>
            </div>
          </div>-->
        </div>
    
        <!--TODO: uncomment <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Memory Leaks</h3>
              <p>TODO</p>
            </div>
          </div>
    
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Garbage Collection</h3>
              <p>TODO</p>
            </div>
          </div>
        </div>-->
    
        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Threading</h3>
              <p>This scenario <b>also</b> utilizes the audioHandler package from Flutter, this package uses threading to play the music in the background. This thread is in charge of queueing audio events, seeking audio, playing audio and pausing audio. This thread allows all the audio related functions to be working outside of the main thread, this is great for playing on background and using the rest of the functions of the app while playing music.</p>
            </div>
          </div>
    
          <div class="col-lg-6" style="align-items: center;">
            <div class="code-space">
              <code-viewer title="audioplayer.dart">
                IconButton(
                  tooltip: AppLocalizations.of(context)!.play,
                  onPressed: audioHandler.play,
                  icon: const Icon(
                    Icons.play_arrow_rounded,
                  ),
                  color: Theme.of(context).iconTheme.color,
                ),
              </code-viewer>
            </div>
          </div>

        </div>
    
      </div>
    </section>

    <section id="ecn4" class="testimonials">
      <div class="container" data-aos="fade-up">
    
        <header class="section-header">
          <h2>Scenario 4</h2>
          <p>Play Offline Song</p>
        </header>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn4Video_1" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1VXrkaEi8d7viLhbuzqKOMegHgehTu-Bn" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Frame rate</h3>
              <p>The app maintains a consistent frame rate exceeding 50 frames per second, and the song plays flawlessly on the cellphone. There are no slow frames (Jank), and the UI is highly responsive with no delays in the rendering of frames within the app.</p>
            </div>
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>CPU</h3>
              <p>Upon selecting a song, the CPU requires up to 5 seconds to fulfill this task. This delay might result in a perceived sluggishness during the song loading process and could potentially hinder other tasks that the CPU is concurrently handling.</p>
            </div>
          </div>
    
          <div class="col-lg-7" data-aos="zoom-out" data-aos-delay="100">
            <img src="assets/img/esc_4_Cpu.png" class="img-fluid custom-image" alt="">
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn4Video_2" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1TQ8xUX_ejNTSGlBhA48Bu_PRqJta_K2t" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>RAM Consumption</h3>
              <p>The app exhibits minimal memory usage, consistently hovering around 100. This figure remains constant as the songs being played have been pre-downloaded into local storage, ensuring playback availability whenever the user desires, irrespective of internet connectivity.</p>
            </div>
          </div>
        </div>
    
        <!--TODO: uncomment <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Memory Leaks</h3>
              <p>TODO</p>
            </div>
          </div>
    
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Garbage Collection</h3>
              <p>TODO</p>
            </div>
          </div>
        </div>-->
    
        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Threading</h3>
              <p>This scenario <b>also</b> utilizes the audioHandler package from Flutter, this package uses threading to play the music in the background. This thread is in charge of queueing audio events, seeking audio, playing audio and pausing audio. This thread allows all the audio related functions to be working outside of the main thread, this is great for playing on background and using the rest of the functions of the app while playing music.</p>
            </div>
          </div>
    
          <div class="col-lg-6" style="align-items: center;">
            <div class="code-space">
              <code-viewer title="audioplayer.dart">
                IconButton(
                  tooltip: AppLocalizations.of(context)!.play,
                  onPressed: audioHandler.play,
                  icon: const Icon(
                    Icons.play_arrow_rounded,
                  ),
                  color: Theme.of(context).iconTheme.color,
                ),
              </code-viewer>
            </div>
          </div>

        </div>
    
      </div>
    </section>

    <section id="ecn5" class="testimonials">
      <div class="container" data-aos="fade-up">
    
        <header class="section-header">
          <h2>Scenario 5</h2>
          <p>Song Search</p>
        </header>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn5Video_1" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1c0KLjHFjnYINAEV7VFM-DP0zWA514rYp" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Frame rate</h3>
              <p>When the keywords are entered into the search bar and the search is initiated, the frames per second begin to fluctuate significantly. Additionally, the request made to YouTube causes a delay in the display of many frames, resulting in what is commonly referred as "Jank."</p>
            </div>
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>CPU</h3>
              <p>In the CPU usage analysis, we notice numerous small calls, possibly arising from the various functions interacting with the YouTube API. However, the task that took up the most time was retrieving and rendering the image of the selected song, lasting almost 4 seconds. This significant duration meant the CPU couldn't execute other processes, like fetching additional artists matching the keywords entered in the search.</p>
            </div>
          </div>
    
          <div class="col-lg-7" data-aos="zoom-out" data-aos-delay="100">
            <img src="assets/img/esc_5_Cpu.png" class="img-fluid custom-image" alt="">
          </div>
        </div>
    
        <br>
    
        <div class="row">
          <div class="col-lg-7 video-center center-vertically">
            <video id="ecn5Video_2" loop controls muted style="width: 100%;">
              <source src="https://drive.google.com/uc?export=download&id=1ZcqsBqoV1hUZc4VGcmrRaOsLV2D29l82" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
    
          <div class="col-lg-5 center-vertically">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>RAM Consumption</h3>
              <p>When examining the memory consumption in the profile, we observe that it is relatively high. This is attributed to the fact that the song is being fetched from the YouTube API and is being cached while being played. In this instance, we note that the download from the YouTube API was restricted to a maximum, preventing the memory spikes experienced in scenario 1. In that scenario, the application downloaded music from its own database and stored it in local storage.</p>
            </div>
          </div>
        </div>
    
        <!--TODO: uncomment <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Memory Leaks</h3>
              <p>TODO</p>
            </div>
          </div>
    
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Garbage Collection</h3>
              <p>TODO</p>
            </div>
          </div>
        </div>-->
    
        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Threading</h3>
              <p>In this scenario, when the user does any search, the engine that allows the information retrieval is a SearchDelegate. As evidenced in the next section, the DataSearch component extends from SearchDelegate. This component uses threads in its advantage to offload tasks that might block the main thread. For example, fetching suggestions or performing search operations in a background.</p>
            </div>
          </div>
    
          <div class="col-lg-6 center-vertically" style="align-items: center;">
            <div class="code-space">
              <code-viewer title="audioplayer.dart">
                class DataSearch extends SearchDelegate {
                  final List&lt;SongModel&gt; data;
                  final String tempPath;
                
              </code-viewer>
            </div>
          </div>

        </div>
    
      </div>
    </section>


    <section id="overdrawing" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>Overdrawing</h2>
          <p>Flutter Overdrawing</p>
        </header>

        <div class="row">
          <div class="col-lg-3 video-center">
            <video id="overdrawingVideo" loop muted style="width: 100%; height: auto;">
              <source src="https://drive.google.com/uc?export=download&id=1OuY3bUA33JxsgEBIiSBlW8u2wbC0H925" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>

          <div class="col-lg-1"></div>

          <div class="col-lg-8 center-vertically">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3></h3>
              <p>
                The overall visual presentation of the app looks quite good. As demonstrated in the video, the app efficiently paints pixels only once, contributing to optimal GPU performance. This efficiency is likely attributed to the use of Flutter for app development, as Flutter appears to be well-optimized. Consequently, apps created with Flutter seem to avoid the issue of overdrawing.
                <br><br>
                In the video, all the pixels of the app are painted in blue, indicating that they are painted only once. Even elements like cards or more complex components don't seem to experience overdrawing issues. This not only enhances the app's visual appeal but also ensures that the GPU isn't burdened with unnecessary rendering tasks, ultimately leading to smoother performance.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>        

    <section id="memory-leaks-library" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>Memory Leaks</h2>
          <p>Libraries for avoiding Memory Leaks</p>
        </header>

        <div class="row">
          <div class="col-lg-4 center-vertically center-horizontally">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3>Dispose</h3>
              <p>In the app, the dispose() method is frequently utilized in various views. Its main purpose is to clean up memory when an object is no longer needed, preventing potential memory leaks in the application. By invoking dispose(), the app ensures that resources are released properly, enhancing overall performance and stability. This is an essential practice to maintain the app's efficiency and prevent unnecessary memory consumption.</p>
            </div>
          </div>

          <div class="col-lg-4 center-vertically center-horizontally">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3>Provider</h3>
              <p>Provider is a state management library that promotes a declarative approach, reducing the likelihood of memory leaks caused by manual state management. By encouraging a more straightforward and structured way of handling state, it contributes to the overall robustness and reliability of the application. This approach helps developers avoid common pitfalls associated with manual state handling and enhances the maintainability of the codebase.</p>
            </div>
          </div>

          <div class="col-lg-4 center-vertically center-horizontally">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3>ListView.builder</h3>
              <p>Using `ListView.builder` is a recommended practice to mitigate the risk of memory leaks. This widget is beneficial because it dynamically generates elements at runtime, as opposed to pre-creating an extensive list of widgets all at once. By adopting this approach, the application efficiently manages memory resources, especially when dealing with large sets of data. This on-demand creation of elements enhances performance.</p>
            </div>
          </div>

        </div>

      </div>
    </section>

    <section id="uoptimization" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>uOptimization</h2>
          <p>Micro-Optimizations</p>
        </header>

        <p class="text-center">
          The micro-optimizations evidenced in the project are present in many forms. However, we only brought here some of the examples, because in general the app is well built and all of the possible micro-optimizations that the app could have are already implemented. Due to this, we only make mention of the slight error that we could notice. For noticing this errors we made use of SonarCube and linter, in which some errors were shown, some of them involved possible micro-optimizations and other were just errors overall. 
        </p>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Indexed loops</h3>
              <p>
                <b>Optimization name:</b> Use indexed loops instead of iterator and for-each loops
                <br><br>
                <b>Reason:</b> This application uses a indexed for loop instead of iterators, this is better in terms of performance, When using a for-each loop Dart creates an iterator object behind the scenes. This iterator object introduces some memory overhead. In contrast, using indexing directly is more memory-efficient as it avoids the creation of an iterator object.
                <br><br>
                <b>Location:</b> This is used inside the app to format the response of an API into a list of Songs, so then another function can format each single song and create objects for each one of the songs.
                <br><br>
                <b>Purpose:</b> The purpose of implementing this in this way is that the response of the API brings many songs and for formatting each one of this songs is necessary to use the function mentioned above, the use of the indexing instead of a for each loop allows the app to work quicker and better.
              </p>
            </div>
          </div>

          <div class="col-lg-6 center-vertically center-horizontally">
            <code-viewer>
              static Future&lt;List&gt; formatSongsResponse(
                List responseList,
                String type,
              ) async {
                final List searchedList = [];
                for (int i = 0; i &lt; responseList.length; i++) {
                  Map? response;
                  switch (type) {
                    case 'song':
                    case 'album':
                    case 'playlist':
                    case 'show':
                    case 'mix':
                      response = await formatSingleSongResponse(responseList[i] as Map);
                      break;
                    default:
                      break;
                  }
              
                  if (response != null && response.containsKey('Error')) {
                    Logger.root.severe(
                      'Error at index $i inside FormatSongsResponse: ${response["Error"]}',
                    );
                  } else {
                    if (response != null) {
                      searchedList.add(response);
                    }
                  }
                }
                return searchedList;
              }
            </code-viewer>
          </div>

        </div>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns green-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Primitive Types</h3>
              <p>
                <b>Optimization name:</b> Prefer primitive types over wrappers, i.e., int vs. Integer
                <br><br>
                <b>Reason:</b> Using primitive types is fundamental, as it helps to improve efficiency both in performance and in memory management. This is because wrappers are objects that contain more space and also the operations needed for using one of this wrapper are more demanding.
                <br><br>
                <b>Location:</b> This snippet of code shown is used in getting all the songs from a playlist and we can evidence how both the index I and the total number of tracks is using int as the type instead of a wrapper of Integer, this makes operations better and quicker.  
                <br><br>
                <b>Purpose:</b> The purpose of implementing this in this way is that the list of all tracks inside a playlist is a iterative process. Using a primitive type inside this process is smart as it uses the best out of the resources of the phone. Reducing memory and CPU usage. 
              </p>
            </div>
          </div>

          <div class="col-lg-6 center-vertically center-horizontally">
            <code-viewer>
              Future&lt;List&gt; getAllTracksOfPlaylist(
                String accessToken,
                String playlistId,
              ) async {
                final List tracks = [];
                int totalTracks = 100;
            
                final Map data = await SpotifyApi().getHundredTracksOfPlaylist(
                  accessToken,
                  playlistId,
                  0,
                );
                totalTracks = data['total'] as int;
                tracks.addAll(data['tracks'] as List);
            
                if (totalTracks > 100) {
                  for (int i = 1; i * 100 &lt;= totalTracks; i++) {
                    final Map data = await SpotifyApi().getHundredTracksOfPlaylist(
                      accessToken,
                      playlistId,
                      i * 100,
                    );
                    tracks.addAll(data['tracks'] as List);
                  }
                }
                return tracks;
              }
            </code-viewer>
          </div>

        </div>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns red-highlight" data-aos="fade-left" data-aos-delay="100">
              <h3>Components LifeCycle</h3>
              <p>
                <b>Optimization name:</b> Components LifeCycle
                <br><br>
                <b>Reason:</b> This happens when using the BuildContext object in an asynchronous operation, and the build context might be disposed of before the operation completes. This can lead to potential memory leaks or unexpected behavior.
                <br><br>
                <b>Location:</b> This snippet of code shown is used to present the downloaded songs. However, this can lead to memory leaks because of accessing the context variable before completion.
                <br><br>
                <b>Solution:</b>  To solve this error, there are many possible ways to address this, one possible solution is to capture the context variable before starting the asynchronous operation, other solution can be using a Completer, this component waits for the operation to finish before using the context.
              </p>
            </div>
          </div>

          <div class="col-lg-6 center-vertically center-horizontally">
            <code-viewer>
              showDialog(
                context: context,
                builder: (BuildContext context) {
                  return AlertDialog(
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(10.0),
                    ),
                    title: Text(
                      AppLocalizations.of(context)!.alreadyExists,
                      style:
                          TextStyle(color: Theme.of(context).colorScheme.secondary),
                    ),
                    content: Column(
                      mainAxisSize: MainAxisSize.min,
                      children: [
                        ...
            </code-viewer>
          </div>

        </div>


      </div>
    </section>

    <section id="prs" class="testimonials">
      <div class="container" data-aos="fade-up">

        <header class="section-header">
          <h2>PRs</h2>
          <p>Pull Requests to BlackHole</p>
        </header>

        <p class="text-center">
          We did 2 pull requests in the BlackHole repository, to help the app improving
        </p>

        <div class="row">
          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3>Enhance Stats Page</h3>
              <p>
                Improve the experience by a new design of the UI in that view. By using colors and centering the cards in the interface. Also, the new UI of this page, is more available to be personalized, by double tapping the screen and changing the color of the stats randomly.
                <br><br>
                <b>Take a look!</b> In the following links you can find the <a target="_blank" href="https://github.com/Sangwan5688/BlackHole/pull/709">PR</a> and the <a target="_blank" href="https://github.com/Sangwan5688/BlackHole/issues/708">issue</a> that was created to enhance the stats page.
              </p>
            </div>
          </div>

          <div class="col-lg-6 center-vertically center-horizontally">
            <div class="box-ecns" data-aos="fade-left" data-aos-delay="100">
              <h3>Add http to pubspec</h3>
              <p>
                As we evidenced in SonarQube and with the linter, there was a requirement that was not in the pubspec file, the http package. This information in the pubspecs allows the app to download this requirements so the app can work properly. Without this, the code will not run and people are going to have to add this line to their pubspec.
                <br><br>
                <b>Take a look!</b> In the following links you can find the <a target="_blank" href="https://github.com/Sangwan5688/BlackHole/pull/748">PR</a> that was created to fix this issue.
              </p>
            </div>
          </div>
        </div>

      </div>
    </section>

  
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">

    <div class="footer-top">
      <div class="container">
        <div class="row gy-1">
          <div class="col-lg-10 col-md-12 footer-info">
            <a href="index.html" class="logo d-flex align-items-center">
              <img src="assets/img/logo.png" alt="">
              <span>Flutter31</span>
            </a>
            <p>At Flutter31, we're a team of developers passionate about Flutter mobile applications. Our focus is on creating and analyzing apps like Blackhole, aiming to enhance your digital experience with innovative and user-friendly solutions.</p>
            <div class="social-links mt-3">
              <a href="https://github.com/ISIS3510-202320-Team31/Flutter" class="github" target="_blank"><i class="bi bi-github"></i></a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong><span>Flutter 31</span></strong>. All Rights Reserved
      </div>
    </div>
  </footer>

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
        var videos = [];
        for (var i = 1; i <= 5; i++) {
            videos.push(document.getElementById('ecn' + i + 'Video_1'));
            videos.push(document.getElementById('ecn' + i + 'Video_2'));
        }
        videos.push(document.getElementById('overdrawingVideo'));

        var checkScroll = function() {
            videos.forEach(function(video) {
                if (video) {
                    var rect = video.getBoundingClientRect();
                    if (rect.top >= 0) {
                        video.play();
                    }
                }
            });
        };

        window.addEventListener('scroll', checkScroll);
        window.addEventListener('resize', checkScroll);

        checkScroll();
    });
  </script>

</body>

</html>